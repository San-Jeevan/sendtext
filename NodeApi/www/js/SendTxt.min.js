function rcvClicked(){event.preventDefault();var n=$("#inputReceive").val();if(n=n.replace(/ /g,""),n==null||n===""){alert("No Code entered!");$("#inputReceive").focus();return}if(n.length!==6){alert("Code is always 6 digits!");$("#inputReceive").focus();return}StartReceiveSession(n)}function sendClicked(){event.preventDefault();var n=$("#inputSend").val();if(n==null||n===""){alert("Cannot send empty message!");$("#inputSend").focus();return}StartSendSession({data:n})}function initClipboardjs(){clipboard.on("success",function(n){n.clearSelection();$("#btnCopy").text("Copied successfully!")});clipboard.on("error",function(){$("#btnCopy").text("Could not copy to clipboard");$("#btnCopy").css("background","red")});clipboardCopyCode.on("success",function(n){n.clearSelection();$("#btnCopyCode").css("background","lightgreen")});clipboardCopyCode.on("error",function(){$("#btnCopyCode").css("background","red")})}function initBindings(){$("#btnReceive").click(rcvClicked);$("#btnSend").click(sendClicked);$('[data-toggle="popover"]').popover();inst=$("[data-remodal-id=modal]").remodal();instrecv=$("[data-remodal-id=modalrecv]").remodal();$(document).on("closed",".remodal",function(){sendmodalopen=!1;$("#btnCopyCode").css("background","#1ab0db")})}function StartReceiveSession(n){$.ajax({type:"GET",url:api_endpoint+"/api/getSession/"+n,crossDomain:!0,success:function(n){n.success&&($("#popuptextarea").val(n.returnobject),instrecv.open(),$("#popuptextarea").select())},error:function(n){console.log(n)}})}function StartSendSession(n){$.ajax({type:"POST",url:api_endpoint+"/api/createSession",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",crossDomain:!0,dataType:"json",success:function(n){var t,i,r;n.success&&(t=n.returnobject.toString().substring(0,3)+" "+n.returnobject.toString().substring(3,6),$("#popupcodespan").val(t),inst.open(),i=600,r=$("#popuptimeleft"),sendmodalopen=!0,startTimer(i,r))},error:function(n){console.log(n)}})}function startTimer(n,t){$("#progressbar").show();var u=n,i,r;timerid=setInterval(function(){sendmodalopen||clearInterval(timerid);i=parseInt(u/60,10);r=parseInt(u%60,10);i=i<10?"0"+i:i;r=r<10?"0"+r:r;t.text(i+":"+r+" remain before expiry");var f=u/n*100;$("#progressbar").attr("aria-valuenow",f).css("width",f+"%");--u<0&&($("#progressbar").hide(),$("#popupcodespan").val("EXPIRED"),clearInterval(timerid))},1e3)}var api_endpoint="http://localhost:1234",options={},inst,instrecv,clipboard=new Clipboard("#btnCopy"),clipboardCopyCode=new Clipboard("#btnCopyCode"),sendmodalopen=!1,timerid=0;jQuery(document).ready(function(){"use strict";initBindings();initClipboardjs()});